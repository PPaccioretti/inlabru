<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Log Gaussian Cox process (LGCP) inference using INLA — lgcp • inlabru</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Log Gaussian Cox process (LGCP) inference using INLA — lgcp" />
<meta property="og:description" content="This function performs inference on a LGCP observed via points residing
possibly multiple dimensions. These dimensions are defined via the left
hand side of the formula provided via the model parameter.
The left hand side determines the intensity function that is assumed to
drive the LGCP. This may include effects that lead to a thinning (filtering)
of the point process. By default, the log intensity is assumed to be a linear
combination of the effects defined by the formula's RHS. More sofisticated
models, e.g. non-linear thinning, can be achieved by using the predictor
argument. The latter requires multiple runs of INLA for improving the
required approximation of the predictor. In many applications the LGCP is
only observed through subsets of the dimensions the process is living in.
For example, spatial point realizations may only be known in sub-areas of
the modelled space. These observed subsets of the LGCP
domain are called samplers and can be provided via the respective parameter.
If samplers is NULL it is assumed that all of the LGCP's dimensions have
been observed completely." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">inlabru</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.3.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/linearapprox.html">Nonlinear model approximation</a>
    </li>
    <li>
      <a href="../articles/method.html">Iterative INLA method</a>
    </li>
    <li>
      <a href="../articles/web/1d_lgcp.html">LGCPs - An example in one dimension</a>
    </li>
    <li>
      <a href="../articles/web/2d_lgcp.html">LGCPs - An example in two dimensions</a>
    </li>
    <li>
      <a href="../articles/web/2d_lgcp_covars.html">LGCPs - Spatial covariates</a>
    </li>
    <li>
      <a href="../articles/web/2d_lgcp_distancesampling.html">LGCPs - Distance sampling</a>
    </li>
    <li>
      <a href="../articles/web/2d_lgcp_multilikelihood.html">LGCPs - Multiple Likelihoods</a>
    </li>
    <li>
      <a href="../articles/web/2d_lgcp_plotsampling.html">LGCPs - Plot sampling</a>
    </li>
    <li>
      <a href="../articles/web/2d_lgcp_spatiotemporal.html">LGCPs - An example in space and time</a>
    </li>
    <li>
      <a href="../articles/web/publications.html">Publications</a>
    </li>
    <li>
      <a href="../articles/web/random_fields.html">Random Fields in One Dimension</a>
    </li>
    <li>
      <a href="../articles/web/random_fields_2d.html">Random Fields in 2D</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/inlabru-org/inlabru/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Log Gaussian Cox process (LGCP) inference using INLA</h1>
    <small class="dont-index">Source: <a href='https://github.com/inlabru-org/inlabru/blob/master/R/bru.inference.R'><code>R/bru.inference.R</code></a></small>
    <div class="hidden name"><code>lgcp.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function performs inference on a LGCP observed via points residing
possibly multiple dimensions. These dimensions are defined via the left
hand side of the formula provided via the model parameter.
The left hand side determines the intensity function that is assumed to
drive the LGCP. This may include effects that lead to a thinning (filtering)
of the point process. By default, the log intensity is assumed to be a linear
combination of the effects defined by the formula's RHS. More sofisticated
models, e.g. non-linear thinning, can be achieved by using the predictor
argument. The latter requires multiple runs of INLA for improving the
required approximation of the predictor. In many applications the LGCP is
only observed through subsets of the dimensions the process is living in.
For example, spatial point realizations may only be known in sub-areas of
the modelled space. These observed subsets of the LGCP
domain are called samplers and can be provided via the respective parameter.
If samplers is NULL it is assumed that all of the LGCP's dimensions have
been observed completely.</p>
    </div>

    <pre class="usage"><span class='fu'>lgcp</span><span class='op'>(</span>
  <span class='va'>components</span>,
  <span class='va'>data</span>,
  samplers <span class='op'>=</span> <span class='cn'>NULL</span>,
  domain <span class='op'>=</span> <span class='cn'>NULL</span>,
  ips <span class='op'>=</span> <span class='cn'>NULL</span>,
  formula <span class='op'>=</span> <span class='va'>.</span> <span class='op'>~</span> <span class='va'>.</span>,
  E <span class='op'>=</span> <span class='cn'>NULL</span>,
  options <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>components</th>
      <td><p>A formula describing the latent components</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>A data frame or <code>SpatialPoints(DataFrame)</code> object</p></td>
    </tr>
    <tr>
      <th>samplers</th>
      <td><p>A data frame or <code>Spatial[Points/Lines/Polygons]DataFrame</code> objects</p></td>
    </tr>
    <tr>
      <th>domain</th>
      <td><p>Named list of domain definitions</p></td>
    </tr>
    <tr>
      <th>ips</th>
      <td><p>Integration points (overrides <code>samplers</code>)</p></td>
    </tr>
    <tr>
      <th>formula</th>
      <td><p>If NULL, the linear combination implied by the <code>components</code>
is used as a predictor for the point location intensity. If a (possibly
non-linear) expression is provided the respective Taylor approximation is
used as a predictor. Multiple runs if INLA are then required for a better
approximation of the posterior.</p></td>
    </tr>
    <tr>
      <th>E</th>
      <td><p>Single numeric used rescale all integration weights by a fixed factor</p></td>
    </tr>
    <tr>
      <th>options</th>
      <td><p>See <code><a href='bru_options.html'>bru_options_set()</a></code></p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An <code><a href='bru.html'>bru()</a></code> object</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'># \donttest{</span>
<span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='bru_safe_inla.html'>bru_safe_inla</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>

  <span class='co'># Load the Gorilla data</span>
  <span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>gorillas</span>, package <span class='op'>=</span> <span class='st'>"inlabru"</span><span class='op'>)</span>

  <span class='co'># Plot the Gorilla nests, the mesh and the survey boundary</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'><a href='gg.html'>gg</a></span><span class='op'>(</span><span class='va'>gorillas</span><span class='op'>$</span><span class='va'>mesh</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'><a href='gg.html'>gg</a></span><span class='op'>(</span><span class='va'>gorillas</span><span class='op'>$</span><span class='va'>nests</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'><a href='gg.html'>gg</a></span><span class='op'>(</span><span class='va'>gorillas</span><span class='op'>$</span><span class='va'>boundary</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_fixed.html'>coord_fixed</a></span><span class='op'>(</span><span class='op'>)</span>

  <span class='co'># Define SPDE prior</span>
  <span class='va'>matern</span> <span class='op'>&lt;-</span> <span class='fu'>INLA</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/INLA/man/inla.spde2.pcmatern.html'>inla.spde2.pcmatern</a></span><span class='op'>(</span><span class='va'>gorillas</span><span class='op'>$</span><span class='va'>mesh</span>,
    prior.sigma <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.1</span>, <span class='fl'>0.01</span><span class='op'>)</span>,
    prior.range <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.01</span>, <span class='fl'>0.01</span><span class='op'>)</span>
  <span class='op'>)</span>

  <span class='co'># Define domain of the LGCP as well as the model components (spatial SPDE</span>
  <span class='co'># effect and Intercept)</span>
  <span class='va'>cmp</span> <span class='op'>&lt;-</span> <span class='va'>coordinates</span> <span class='op'>~</span> <span class='fu'>mySmooth</span><span class='op'>(</span>map <span class='op'>=</span> <span class='va'>coordinates</span>, model <span class='op'>=</span> <span class='va'>matern</span><span class='op'>)</span> <span class='op'>+</span> <span class='va'>Intercept</span>

  <span class='co'># Fit the model (with int.strategy="eb" to make the example take less time)</span>
  <span class='va'>fit</span> <span class='op'>&lt;-</span> <span class='fu'>lgcp</span><span class='op'>(</span><span class='va'>cmp</span>, <span class='va'>gorillas</span><span class='op'>$</span><span class='va'>nests</span>,
    samplers <span class='op'>=</span> <span class='va'>gorillas</span><span class='op'>$</span><span class='va'>boundary</span>,
    domain <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>coordinates <span class='op'>=</span> <span class='va'>gorillas</span><span class='op'>$</span><span class='va'>mesh</span><span class='op'>)</span>,
    options <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>control.inla <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>int.strategy <span class='op'>=</span> <span class='st'>"eb"</span><span class='op'>)</span><span class='op'>)</span>
  <span class='op'>)</span>

  <span class='co'># Predict the spatial intensity surface</span>
  <span class='va'>lambda</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/raster/man/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>fit</span>, <span class='fu'><a href='pixels.html'>pixels</a></span><span class='op'>(</span><span class='va'>gorillas</span><span class='op'>$</span><span class='va'>mesh</span><span class='op'>)</span>, <span class='op'>~</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='va'>mySmooth</span> <span class='op'>+</span> <span class='va'>Intercept</span><span class='op'>)</span><span class='op'>)</span>

  <span class='co'># Plot the intensity</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'><a href='gg.html'>gg</a></span><span class='op'>(</span><span class='va'>lambda</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'><a href='gg.html'>gg</a></span><span class='op'>(</span><span class='va'>gorillas</span><span class='op'>$</span><span class='va'>mesh</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'><a href='gg.html'>gg</a></span><span class='op'>(</span><span class='va'>gorillas</span><span class='op'>$</span><span class='va'>nests</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'><a href='gg.html'>gg</a></span><span class='op'>(</span><span class='va'>gorillas</span><span class='op'>$</span><span class='va'>boundary</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_fixed.html'>coord_fixed</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='op'>}</span>
</div><div class='output co'>#&gt; <span class='message'>Regions defined for each Polygons</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Discarded ellps unknown in Proj4 definition: +proj=longlat +R=1 +no_defs +type=crs</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Discarded datum unknown in Proj4 definition</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Discarded ellps unknown in Proj4 definition: +proj=longlat +R=6378137 +no_defs +type=crs</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Discarded datum unknown in Proj4 definition</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Discarded ellps unknown in Proj4 definition: +proj=longlat +R=6378137 +no_defs +type=crs</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Discarded datum unknown in Proj4 definition</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Discarded ellps unknown in Proj4 definition: +proj=geocent +R=1 +units=m +no_defs +type=crs</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Discarded datum unknown in Proj4 definition</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Use of 'map' is deprecated and may be disabled; use 'main' instead.</span></div><div class='output co'>#&gt; <span class='warning'>Warning: All covariate evaluations for 'Intercept' are NULL; an intercept component was likely intended.</span>
#&gt; <span class='warning'>  Implicit latent intercept component specification is deprecated since version 2.1.14.</span>
#&gt; <span class='warning'>  Use explicit notation '+ Intercept(1)' instead (or '+1' for '+ Intercept(1)').</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Discarded ellps unknown in Proj4 definition: +proj=longlat +R=1 +no_defs +type=crs</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Discarded datum unknown in Proj4 definition</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Discarded ellps unknown in Proj4 definition: +proj=longlat +R=6378137 +no_defs +type=crs</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Discarded datum unknown in Proj4 definition</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Discarded ellps unknown in Proj4 definition: +proj=longlat +R=6378137 +no_defs +type=crs</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Discarded datum unknown in Proj4 definition</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Discarded ellps unknown in Proj4 definition: +proj=geocent +R=1 +units=m +no_defs +type=crs</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Discarded datum unknown in Proj4 definition</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Discarded ellps unknown in Proj4 definition: +proj=longlat +R=1 +no_defs +type=crs</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Discarded datum unknown in Proj4 definition</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Discarded ellps unknown in Proj4 definition: +proj=longlat +R=6378137 +no_defs +type=crs</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Discarded datum unknown in Proj4 definition</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Discarded ellps unknown in Proj4 definition: +proj=longlat +R=6378137 +no_defs +type=crs</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Discarded datum unknown in Proj4 definition</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Discarded ellps unknown in Proj4 definition: +proj=geocent +R=1 +units=m +no_defs +type=crs</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Discarded datum unknown in Proj4 definition</span></div><div class='output co'>#&gt; <span class='message'>Regions defined for each Polygons</span></div><div class='img'><img src='lgcp-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># }</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Finn Lindgren, Fabian E. Bachl.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


